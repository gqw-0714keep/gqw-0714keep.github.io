
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
        <title>报表服务器 | OneFrog</title>
        <meta name="author" content="一只青蛙">
        <meta name="description" content="日常学习笔记">
        <meta name="keywords" content="">
        <link rel="icon" href="https://s1.328888.xyz/2022/05/16/qNGAC.jpg">
        <script src="https://cdn.staticfile.org/instant.page/5.1.0/instantpage.min.js" type="module"></script>
        <script src="https://cdn.staticfile.org/font-awesome/6.1.1/js/all.min.js"></script>
        <link rel="stylesheet" href="/css/fonts.min.css">
        <link rel="stylesheet" href="/css/particlex.css">
        <script src="https://cdn.staticfile.org/vue/3.2.33/vue.global.prod.min.js"></script>
    <meta name="generator" content="Hexo 6.2.0"></head>
    <body>
        <div id="loading" style="height:100vh;width:100vw;position:fixed;display:flex;z-index:200;justify-content:space-between;background:#fff;transition:opacity 0.3s ease-out"><div style="position:fixed;height:100vh;width:100vw;display:flex;justify-content:center;align-items:center"><div id="loadcontent" style="width:50vmin;height:50vmin;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px #a3ddfb;text-align:center"><div><h2>LOADING...</h2><p style="word-break:keep-all">加载过慢请开启缓存(浏览器默认开启)</p><div><img alt="loading" src="/loading.gif"></div></div></div></div></div>
        <div id="layout">
            <i data-fa-symbol="calendar-solid" class="fa-solid fa-calendar fa-fw"></i>
            <i data-fa-symbol="bookmark-solid" class="fa-solid fa-bookmark fa-fw"></i>
            <i data-fa-symbol="tags-solid" class="fa-solid fa-tags fa-fw"></i>
            <transition name="into">
                <div v-show="show_page" style="display: -not-none">
                    <div id="menu_show">
                         
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">OneFrog</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-home fa-fw"></i>
            <span>&ensp;主页</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;关于</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;归档</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;分类</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;标签</span>
        </a>
        
    </div>
    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div class="curtain" @click="menu_show = !menu_show" v-show="menu_show"></div>
        <div :class="'title'" @click="menu_show = !menu_show">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;OneFrog</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="menu_show">
            
            <a href="/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-home fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">主页</div>
                </div>
            </a>
            
            <a href="/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">关于</div>
                </div>
            </a>
            
            <a href="/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">归档</div>
                </div>
            </a>
            
            <a href="/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">分类</div>
                </div>
            </a>
            
            <a href="/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">标签</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>
                    </div>
                    <div id="main">
                        
<div class="article">
    <div>
        <h1>报表服务器 </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <svg class="fa-icon"><use xlink:href="#calendar-solid"></use></svg>
            </span>
            2022/5/6
        </span>
        
        <span class="category">
            <a href="/categories/ReportServer">
                <span class="icon">
                    <svg class="fa-icon"><use xlink:href="#bookmark-solid"></use></svg>
                </span>
                ReportServer
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <svg class="fa-icon"><use xlink:href="#tags-solid"></use></svg>
            </span>
            
            <span class="tag">
                
                <a href="/tags/reportBuilder" style="color: #00a596">
                    reportBuilder
                </a>
            </span>
            
        </span>
        
    </div>
    <div class="content" v-pre>
        <p><strong><font color=HotPink size="3.5" >简单上手Microsoft Report Builder的基本操作</font></strong></p>
<span id="more"></span>



<h3 id="1-关于文本"><a href="#1-关于文本" class="headerlink" title="1.关于文本"></a>1.关于文本</h3><h4 id="1-1-属性Value"><a href="#1-1-属性Value" class="headerlink" title="1.1 属性Value"></a>1.1 属性Value</h4><p>★在不使用任何图表的情况下，<strong>数据集</strong>中的字段在运行后只会查询并显示对应内容的第一条记录，此时选定文本的属性<strong>Value</strong>为</p>
<pre><code class="vb">=First(Fields!FullName.Value, &quot;TextDataSet&quot;)
</code></pre>
<p><img src="https://s1.328888.xyz/2022/05/18/DpQgP.png"></p>
<p>★当他在图表中出现时属性<strong>Value</strong>为</p>
<pre><code class="vb">=Fields!FullName.Value
</code></pre>
<p><img src="https://s1.328888.xyz/2022/05/18/DCPZq.png"></p>
<h4 id="1-2-向报表添加超链接"><a href="#1-2-向报表添加超链接" class="headerlink" title="1.2 向报表添加超链接"></a>1.2 向报表添加超链接</h4><p>选中文本，在属性中打开<strong>Action</strong>，在操作中勾选 <strong>转到URL</strong>，然后编辑你想要跳转的URL</p>
<p><img src="https://s1.328888.xyz/2022/05/18/DpU5m.png"></p>
<p>选中字体，在主页的选项卡中可以设置字体相关内容，下图中可以调节字体颜色</p>
<p><img src="https://s1.328888.xyz/2022/05/18/DpekA.png"></p>
<h4 id="1-3-旋转报表中的文本"><a href="#1-3-旋转报表中的文本" class="headerlink" title="1.3 旋转报表中的文本"></a>1.3 旋转报表中的文本</h4><p>选中单元格之后，在本地化中修改WritingMode属性为“Rotate270”</p>
<p><img src="https://s1.328888.xyz/2022/05/18/DpyQS.png"></p>
<h4 id="1-4-设置货币格式"><a href="#1-4-设置货币格式" class="headerlink" title="1.4 设置货币格式"></a>1.4 设置货币格式</h4><p>选中整个单元格（可多选），在主页的选项卡上由默认值切换为货币，其中的“ , ”号双击取消货币的分隔符号</p>
<p>如 ：                        </p>
<p>​          [¥12345.00]                                        [¥12,345.00]    </p>
<p>相对应的，在该单元格的数字属性Format也会发生改变</p>
<img src="https://s1.328888.xyz/2022/05/18/DpGHR.png" style="zoom:80%;" />





<h4 id="1-5-使用HTML格式显示文本"><a href="#1-5-使用HTML格式显示文本" class="headerlink" title="1.5 使用HTML格式显示文本"></a>1.5 使用HTML格式显示文本</h4><p>在插入中选中文本框进行创建</p>
<p>将下列文本粘贴到文本框</p>
<pre><code class="html">&lt;h4&gt;Limitations of cascading style sheet attributes&lt;/h4&gt;  
      &lt;p&gt;Only a basic set of &lt;b&gt;cascading style sheet (CSS)&lt;/b&gt; attributes are defined:&lt;/p&gt;  
      &lt;ul&gt;&lt;li&gt;  
          text-align, text-indent  
        &lt;/li&gt;&lt;li&gt;  
          font-family, font-size  
        &lt;/li&gt;&lt;li&gt;  
          color  
        &lt;/li&gt;&lt;li&gt;  
          padding, padding-bottom, padding-top, padding-right, padding-left  
        &lt;/li&gt;&lt;li&gt;  
          font-weight  
        &lt;/li&gt;&lt;/ul&gt;
</code></pre>
<p>选中刚刚复制的文本，右键单击后选择<strong>文本属性</strong>，在常规里面将标记类型更改为 <strong>HTML - 将HTML 标记解释为样式</strong></p>
<p><img src="https://s1.328888.xyz/2022/05/18/DpZvJ.png"></p>
<h3 id="2-关于柱形图"><a href="#2-关于柱形图" class="headerlink" title="2.关于柱形图"></a>2.关于柱形图</h3><h4 id="2-1-添加柱形图"><a href="#2-1-添加柱形图" class="headerlink" title="2.1 添加柱形图"></a>2.1 添加柱形图</h4><p>将下列sql复制到数据集当中</p>
<pre><code class="sql">SELECT CAST(&#39;2015-01-01&#39; AS date) AS SalesDate, CAST(54995.21 AS money) AS Sales  
UNION SELECT CAST(&#39;2015-01-05&#39; AS date) AS SalesDate, CAST(64499.04 AS money) AS Sales  
UNION SELECT CAST(&#39;2015-02-11&#39; AS date) AS SalesDate, CAST(37821.79 AS money) AS Sales  
UNION SELECT CAST(&#39;2015-03-18&#39; AS date) AS SalesDate, CAST(53633.08 AS money) AS Sales  
UNION SELECT CAST(&#39;2015-04-23&#39; AS date) AS SalesDate, CAST(24019.3 AS money) AS Sales  
UNION SELECT CAST(&#39;2015-05-01&#39; AS date) AS SalesDate, CAST(93245.5 AS money) AS Sales  
UNION SELECT CAST(&#39;2015-06-06&#39; AS date) AS SalesDate, CAST(55288.0 AS money) AS Sales  
UNION SELECT CAST(&#39;2015-06-16&#39; AS date) AS SalesDate, CAST(68733.5 AS money) AS Sales  
UNION SELECT CAST(&#39;2015-07-16&#39; AS date) AS SalesDate, CAST(24750.85 AS money) AS Sales  
UNION SELECT CAST(&#39;2015-08-23&#39; AS date) AS SalesDate, CAST(43452.3 AS money) AS Sales  
UNION SELECT CAST(&#39;2015-09-24&#39; AS date) AS SalesDate, CAST(58656. AS money) AS Sales  
UNION SELECT CAST(&#39;2015-10-15&#39; AS date) AS SalesDate, CAST(44583. AS money) AS Sales  
UNION SELECT CAST(&#39;2015-11-21&#39; AS date) AS SalesDate, CAST(81568. AS money) AS Sales  
UNION SELECT CAST(&#39;2015-12-15&#39; AS date) AS SalesDate, CAST(45973. AS money) AS Sales  
UNION SELECT CAST(&#39;2015-12-26&#39; AS date) AS SalesDate, CAST(96357. AS money) AS Sales  
UNION SELECT CAST(&#39;2015-12-31&#39; AS date) AS SalesDate, CAST(81946. AS money) AS Sales
</code></pre>
<p>在插入中选择<strong>图表</strong>—<strong>图表导向</strong>—列，选择<strong>数据源</strong></p>
<p>在<strong>排列图表字段页</strong>上，将 SalesDate 字段拖到<strong>类别</strong>中 。 “类别”显示在<strong>水平轴</strong>上。</p>
<p>将 Sales 字段拖到<strong>值</strong>中。 “值”框显示 Sum(Sales)，因为销售总计值之和是对每个日期的合计。 “值”显示在<strong>垂直轴</strong>上。</p>
<p><img src="https://s1.328888.xyz/2022/05/18/DpvJF.png"></p>
<h4 id="2-2-设置水平轴上的日期格式"><a href="#2-2-设置水平轴上的日期格式" class="headerlink" title="2.2 设置水平轴上的日期格式"></a>2.2 设置水平轴上的日期格式</h4><p>选中水平轴，右键单击选择水平轴属性，在数字选项中更改类别为日期（类型自选），点击确定进行修改</p>
<p><img src="https://s1.328888.xyz/2022/05/18/Dp6zW.png"></p>
<h4 id="2-3-旋转水平轴标签"><a href="#2-3-旋转水平轴标签" class="headerlink" title="2.3 旋转水平轴标签"></a>2.3 旋转水平轴标签</h4><p>选中水平轴，右键单击选择水平轴属性，在标签中选中禁用自动调整然后修改自己想要旋转的角度</p>
<img src="https://s1.328888.xyz/2022/05/18/DpoDd.png" />





<h4 id="2-4-设置垂直轴的格式和标签"><a href="#2-4-设置垂直轴的格式和标签" class="headerlink" title="2.4 设置垂直轴的格式和标签"></a>2.4 设置垂直轴的格式和标签</h4><p>选中垂直轴，右键单击选择垂直轴属性，在数字中更改类别为货币，将小数位数设置为0，显示单位为千</p>
<p><img src="https://s1.328888.xyz/2022/05/18/DpB3Q.png"></p>
<h4 id="2-5-调整水平轴上标签的间隔"><a href="#2-5-调整水平轴上标签的间隔" class="headerlink" title="2.5 调整水平轴上标签的间隔"></a>2.5 调整水平轴上标签的间隔</h4><p>在实际运行时下方x轴标签只显示了部分，单击水平轴在属性框中找到<strong>Labels</strong>下的<strong>LabelInterval</strong>属性设置为1，运行一下试试</p>
<h4 id="2-6添加带已计算序列的移动平均线"><a href="#2-6添加带已计算序列的移动平均线" class="headerlink" title="2.6添加带已计算序列的移动平均线"></a>2.6添加带已计算序列的移动平均线</h4><p>双击图表以显示“图表数据”窗格</p>
<p>右键单击“值”区域中的“[Sum(Sales)]”字段，然后单击“添加计算序列” </p>
<p><img src="https://docs.microsoft.com/zh-cn/sql/reporting-services/media/report-builder-column-chart-add-calculated-series.png?view=sql-server-ver15"></p>
<p>在“公式”中，验证是否已选中“移动平均线” </p>
<p>在“设置公式参数”中，针对“期间”，选择“4” </p>
<p>在“边框”选项卡的“线条宽度”中，选择“3磅” </p>
<h3 id="3-关于饼图"><a href="#3-关于饼图" class="headerlink" title="3.关于饼图"></a>3.关于饼图</h3><h4 id="3-1-添加饼图"><a href="#3-1-添加饼图" class="headerlink" title="3.1 添加饼图"></a>3.1 添加饼图</h4><p>将下列sql复制到数据集当中</p>
<pre><code class="sql">SELECT &#39;Advanced Digital Camera&#39; AS Product, CAST(254995.21 AS money) AS Sales  
UNION SELECT &#39;Slim Digital Camera&#39; AS Product, CAST(164499.04 AS money) AS Sales  
UNION SELECT &#39;SLR Digital Camera&#39; AS Product, CAST(782176.79 AS money) AS Sales  
UNION SELECT &#39;Lens Adapter&#39; AS Product, CAST(36333.08 AS money) AS Sales  
UNION SELECT &#39;Macro Zoom Lens&#39; AS Product, CAST(40199.3 AS money) AS Sales  
UNION SELECT &#39;USB Cable&#39; AS Product, CAST(53245.5 AS money) AS Sales  
UNION SELECT &#39;Independent Filmmaker Camcorder&#39; AS Product, CAST(452288.0 AS money) AS Saless  
UNION SELECT &#39;Full Frame Digital Camera&#39; AS Product, CAST(247250.85 AS money) AS Sales
</code></pre>
<p>在插入中选择<strong>图表</strong>—<strong>图表导向</strong>—<strong>饼图</strong>，选择<strong>数据源</strong></p>
<p>在<strong>排列图表字段</strong>，将“Product”字段拖到“类别”窗格中，将“Sales”字段拖到“值”窗格中</p>
<h4 id="3-2-在每个切片中显示百分比"><a href="#3-2-在每个切片中显示百分比" class="headerlink" title="3.2 在每个切片中显示百分比"></a>3.2 在每个切片中显示百分比</h4><p>右键单击饼图，然后单击“显示数据标签”， 数据标签会显示在图表上</p>
<p>右键单击标签，然后单击“序列标签属性”</p>
<p>在“标签数据”框中，选择“#PERCENT”</p>
<p>若要指定标签显示的小数位数，在“标签数据”框的“#PERCENT”后面键入 **{Pn}**，其中 n 为要显示的小数位数。 例如，若不显示小数位数，请键入 <strong>#PERCENT{P0}</strong> </p>
<p>若要将值显示为百分比，则 UseValueAsLabel 属性必须为 false。 如果系统提示设置此值，请在“确认操作”对话框中单击“是”</p>
<h4 id="3-3-将多个小型切片合并为一个切片"><a href="#3-3-将多个小型切片合并为一个切片" class="headerlink" title="3.3  将多个小型切片合并为一个切片"></a>3.3  将多个小型切片合并为一个切片</h4><p>如果未显示”属性”窗格，请在”视图”选项卡上的”显示**&#x2F;隐藏组**”中选择”属性**”**。</p>
<p>在设计图面上，单击饼图的任一切片。 序列的属性将显示在“属性”窗格中。</p>
<p>在 <strong>“常规”</strong> 部分，展开 <strong>CustomAttributes</strong> 节点</p>
<p>将“CollectedStyle”属性设置为“SingleSlice”</p>
<p>确保将“CollectedThreshold”属性设置为“5”</p>
<p>确保将“CollectedThresholdUsePercent”属性设置为“True”</p>
<h3 id="4-关于条形图"><a href="#4-关于条形图" class="headerlink" title="4.关于条形图"></a>4.关于条形图</h3><h4 id="4-1-创建条形图"><a href="#4-1-创建条形图" class="headerlink" title="4.1 创建条形图"></a>4.1 创建条形图</h4><p>复制下方sql到数据集中</p>
<pre><code class="sql">SELECT &#39;Luis&#39; as FirstName, &#39;Alverca&#39; as LastName, CAST(170000.00 AS money) AS SalesYear2015, CAST(150000. AS money) AS SalesYear2014  
UNION SELECT &#39;Jeffrey&#39; as FirstName, &#39;Zeng&#39; as LastName, CAST(210000. AS money) AS SalesYear2015, CAST(190000. AS money) AS SalesYear2014  
UNION SELECT &#39;Houman&#39; as FirstName, &#39;Pournasseh&#39; as LastName, CAST(150000. AS money) AS SalesYear2015, CAST(180000. AS money) AS SalesYear2014  
UNION SELECT &#39;Robin&#39; as FirstName, &#39;Wood&#39; as LastName, CAST(75000. AS money) AS SalesYear2015, CAST(175000. AS money) AS SalesYear2014  
UNION SELECT &#39;Daniela&#39; as FirstName, &#39;Guaita&#39; as LastName,  CAST(170000. AS money) AS SalesYear2015, CAST(175000. AS money) AS SalesYear2014  
UNION SELECT &#39;John&#39; as FirstName, &#39;Yokim&#39; as LastName, CAST(160000. AS money) AS SalesYear2015, CAST(195000. AS money) AS SalesYear2014  
UNION SELECT &#39;Delphine&#39; as FirstName, &#39;Ribaute&#39; as LastName, CAST(180000. AS money) AS SalesYear2015, CAST(205000. AS money) AS SalesYear2014  
UNION SELECT &#39;Robert&#39; as FirstName, &#39;Hernady&#39; as LastName, CAST(140000. AS money) AS SalesYear2015, CAST(180000. AS money) AS SalesYear2014  
UNION SELECT &#39;Tanja&#39; as FirstName, &#39;Plate&#39; as LastName, CAST(150000. AS money) AS SalesYear2015, CAST(160000. AS money) AS SalesYear2014  
UNION SELECT &#39;David&#39; as FirstName, &#39;Bradley&#39; as LastName, CAST(210000. AS money) AS SalesYear2015, CAST(180000. AS money) AS SalesYear2014  
UNION SELECT &#39;Michal&#39; as FirstName, &#39;Jaworski&#39; as LastName, CAST(175000. AS money) AS SalesYear2015, CAST(220000. AS money) AS SalesYear2014  
UNION SELECT &#39;Chris&#39; as FirstName, &#39;Ashton&#39; as LastName, CAST(195000. AS money) AS SalesYear2015, CAST(205000. AS money) AS SalesYear2014  
UNION SELECT &#39;Pongsiri&#39; as FirstName, &#39;Hirunyanitiwatna&#39; as LastName, CAST(175000. AS money) AS SalesYear2015, CAST(215000. AS money) AS SalesYear2014  
UNION SELECT &#39;Brian&#39; as FirstName, &#39;Burke&#39; as LastName, CAST(187000. AS money) AS SalesYear2015, CAST(207000. AS money) AS SalesYear2014
</code></pre>
<p>将 LastName 拖动到“类别”窗格</p>
<p>将 SalesYear2015 拖动到“值”窗格。 SalesYear2015 表示每个销售人员在 2015 年的销售总额。 “值”窗格显示<code>[Sum(SalesYear2015)]</code> ，因为该图表显示的是每个产品的销售总额</p>
<p>将 SalesYear2014 拖动到 SalesYear2015 下的“值”窗格SalesYear2014 表示每个销售人员在 2014 年的销售总额</p>
<h4 id="4-2-在垂直轴上显示所有名称"><a href="#4-2-在垂直轴上显示所有名称" class="headerlink" title="4.2 在垂直轴上显示所有名称"></a>4.2 在垂直轴上显示所有名称</h4><p>选中垂直轴右键单击选择<strong>垂直轴属性</strong>，在轴选项中设置间隔为1</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0UvT.png"></p>
<h4 id="4-3-为lastname加上firstname"><a href="#4-3-为lastname加上firstname" class="headerlink" title="4.3 为lastname加上firstname"></a>4.3 为lastname加上firstname</h4><p>双击图表，在一旁的图表数据中的类别组区域中，右键单击选择类别组属性，然后更改标签的表达式（fx）按钮</p>
<p>键入以下表达式 ,它将连接姓氏，空格和名字</p>
<pre><code>=Fields!LastName.Value &amp; &quot; &quot; &amp; Fields!FirstName.Value
</code></pre>
<p><img src="https://s1.328888.xyz/2022/05/18/D0QIB.png"></p>
<h4 id="4-4-更改垂直轴上的排序顺序"><a href="#4-4-更改垂直轴上的排序顺序" class="headerlink" title="4.4 更改垂直轴上的排序顺序"></a>4.4 更改垂直轴上的排序顺序</h4><p>同4.3操作一样，打开类别组属性，更改排序依据</p>
<p><img src="https://s1.328888.xyz/2022/05/18/Dpx84.png"></p>
<h4 id="4-5-控制显示内容条数"><a href="#4-5-控制显示内容条数" class="headerlink" title="4.5 控制显示内容条数"></a>4.5 控制显示内容条数</h4><p>同4.3一致，在类别组属性的筛选器添加一个表达式<code>=Sum(Fields!SalesYear2015.Value)</code>验证确保数据类型是“文本“，在运算符中选择前N个，值中填入N</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0uL2.png"></p>
<h3 id="5-关于迷你图"><a href="#5-关于迷你图" class="headerlink" title="5.关于迷你图"></a>5.关于迷你图</h3><h4 id="5-1-添加迷你图"><a href="#5-1-添加迷你图" class="headerlink" title="5.1 添加迷你图"></a>5.1 添加迷你图</h4><p>复制下方sql到数据集中</p>
<pre><code class="sql">SELECT CAST(&#39;2015-01-04&#39; AS date) as SalesDate, &#39;Accessories&#39; as Subcategory,   
   &#39;Carrying Case&#39; as Product, CAST(16996.60 AS money) AS Sales, 68 as Quantity  
UNION SELECT CAST(&#39;2015-01-05&#39; AS date) as SalesDate, &#39;Accessories&#39; as Subcategory,  
   &#39;Carrying Case&#39; as Product, CAST(1350.00 AS money) AS Sales, 18 as Quantity  
UNION SELECT CAST(&#39;2015-01-10&#39; AS date) as SalesDate, &#39;Accessories&#39; as Subcategory,  
   &#39;Carrying Case&#39; as Product, CAST(1147.50 AS money) AS Sales, 17 as Quantity  
UNION SELECT CAST(&#39;2015-01-04&#39; AS date) as SalesDate, &#39;Accessories&#39; as Subcategory,  
   &#39;Budget Movie-Maker&#39; as Product, CAST(1056.00 AS money) AS Sales, 44 as Quantity  
UNION SELECT CAST(&#39;2015-01-05&#39; AS date) as SalesDate,  &#39;Accessories&#39; as Subcategory,  
   &#39;Slim Digital&#39; as Product, CAST(1380.00 AS money) AS Sales, 18 as Quantity  
UNION SELECT CAST(&#39;2015-01-05&#39; AS date) as SalesDate,&#39;Accessories&#39; as Subcategory,    
   &#39;Budget Movie-Maker&#39; as Product, CAST(780.00 AS money) AS Sales, 26 as Quantity  
UNION SELECT CAST(&#39;2015-01-07&#39; AS date) as SalesDate, &#39;Accessories&#39; as Subcategory,   
   &#39;Budget Movie-Maker&#39; as Product, CAST(3798.00 AS money) AS Sales, 9 as Quantity  
UNION SELECT CAST(&#39;2015-01-08&#39; AS date) as SalesDate, &#39;Camcorders&#39; as Subcategory,   
   &#39;Budget Movie-Maker&#39; as Product, CAST(10400.00 AS money) AS Sales, 13 as Quantity  
UNION SELECT CAST(&#39;2015-01-09&#39; AS date) as SalesDate, &#39;Camcorders&#39; as Subcategory,   
   &#39;Budget Movie-Maker&#39; as Product, CAST(3000.00 AS money) AS Sales, 60 as Quantity  
UNION SELECT CAST(&#39;2015-01-10&#39; AS date) as SalesDate,  &#39;Digital&#39; as Subcategory,   
   &#39;Budget Movie-Maker&#39; as Product, CAST(7234.50 AS money) AS Sales, 39 as Quantity  
UNION SELECT CAST(&#39;2015-01-06&#39; AS date) as SalesDate,  &#39;Digital&#39; as Subcategory,   
   &#39;Carrying Case&#39; as Product, CAST(10836.00 AS money) AS Sales, 84 as Quantity  
UNION SELECT CAST(&#39;2015-01-07&#39; AS date) as SalesDate,  &#39;Digital&#39; as Subcategory,   
   &#39;Slim Digital&#39; as Product, CAST(2550.00 AS money) AS Sales, 17 as Quantity  
UNION SELECT CAST(&#39;2015-01-04&#39; AS date) as SalesDate, &#39;Digital&#39; as Subcategory,   
   &#39;Slim Digital&#39; as Product, CAST(8357.80 AS money) AS Sales, 44 as Quantity  
UNION SELECT CAST(&#39;2015-01-08&#39; AS date) as SalesDate, &#39;Digital SLR&#39; as Subcategory,   
   &#39;Slim Digital&#39; as Product, CAST(18530.00 AS money) AS Sales, 34 as Quantity  
UNION SELECT CAST(&#39;2015-01-06&#39; AS date) as SalesDate, &#39;Digital SLR&#39; as Subcategory,   
   &#39;Slim Digital&#39; as Product, CAST(26576.00 AS money) AS Sales, 88 as Quantity
</code></pre>
<p>使用矩形向导，在“排列字段”页上，将 Sales 拖到“值”中 ，<strong>Sales</strong> 由 Sum 函数聚合。 值为 [Sum(Sales)]，将 Product 拖到“行组”中 ，将 SalesDate 拖到“列组”中 </p>
<p>在设计画面中插入列，然后选中右键单击选择插入，选择迷你图，使用列的第一个迷你图</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0yzM.png"></p>
<p>单击图表打开图表数据，在值里加入Sales，在类别组中加入SalesDate</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0G17.png"></p>
<h4 id="5-2-沿水平方向和垂直方向对齐迷你图"><a href="#5-2-沿水平方向和垂直方向对齐迷你图" class="headerlink" title="5.2 沿水平方向和垂直方向对齐迷你图"></a>5.2 沿水平方向和垂直方向对齐迷你图</h4><p>默认迷你图是根据每一条数据来显示尺度，所以可以将它们进行统一</p>
<p>首先右键单击迷你图打开垂直轴属性，勾选对齐其中的轴，途中Tablix1是列表中唯一的选项，该设置对相对于其他条形的<strong>高度</strong></p>
<p><img src="https://s1.328888.xyz/2022/05/18/D09uX.png"></p>
<p>同样还有水平轴属性，同上，该设置为条形的<strong>宽度</strong></p>
<p>注意的是对于缺失的数据具有空白空间</p>
<p><img src="https://docs.microsoft.com/zh-cn/sql/reporting-services/media/report-builder-sparkline-aligned.png?view=sql-server-ver15"></p>
<h3 id="6-关于KPI"><a href="#6-关于KPI" class="headerlink" title="6.关于KPI"></a>6.关于KPI</h3><h4 id="6-1-使用背景色显示kpi的当前状态"><a href="#6-1-使用背景色显示kpi的当前状态" class="headerlink" title="6.1 使用背景色显示kpi的当前状态"></a>6.1 使用背景色显示kpi的当前状态</h4><pre><code class="sql">SELECT CAST(&#39;2015-01-05&#39; AS date) as SalesDate, &#39;Accessories&#39; as Subcategory,   
   &#39;Carrying Case&#39; as Product, CAST(16996.60 AS money) AS Sales, 68 as Quantity  
UNION SELECT CAST(&#39;2015-01-06&#39; AS date) as SalesDate, &#39;Accessories&#39; as Subcategory,  
   &#39;Tripod&#39; as Product, CAST(1350.00 AS money) AS Sales, 18 as Quantity  
UNION SELECT CAST(&#39;2015-01-11&#39; AS date) as SalesDate, &#39;Accessories&#39; as Subcategory,  
   &#39;Lens Adapter&#39; as Product, CAST(1147.50 AS money) AS Sales, 17 as Quantity  
UNION SELECT CAST(&#39;2015-01-05&#39; AS date) as SalesDate, &#39;Accessories&#39; as Subcategory,  
   &#39;Mini Battery Charger&#39; as Product, CAST(1056.00 AS money) AS Sales, 44 as Quantity  
UNION SELECT CAST(&#39;2015-01-06&#39; AS date) as SalesDate,  &#39;Accessories&#39; as Subcategory,  
   &#39;Telephoto Conversion Lens&#39; as Product, CAST(1380.00 AS money) AS Sales, 18 as Quantity  
UNION SELECT CAST(&#39;2015-01-06&#39; AS date) as SalesDate,&#39;Accessories&#39; as Subcategory,    
   &#39;USB Cable&#39; as Product, CAST(780.00 AS money) AS Sales, 26 as Quantity  
UNION SELECT CAST(&#39;2015-01-08&#39; AS date) as SalesDate, &#39;Accessories&#39; as Subcategory,   
   &#39;Budget Movie-Maker&#39; as Product, CAST(3798.00 AS money) AS Sales, 9 as Quantity  
UNION SELECT CAST(&#39;2015-01-09&#39; AS date) as SalesDate, &#39;Camcorders&#39; as Subcategory,   
   &#39;Business Videographer&#39; as Product, CAST(10400.00 AS money) AS Sales, 13 as Quantity  
UNION SELECT CAST(&#39;2015-01-10&#39; AS date) as SalesDate, &#39;Camcorders&#39; as Subcategory,   
   &#39;Social Videographer&#39; as Product, CAST(3000.00 AS money) AS Sales, 60 as Quantity  
UNION SELECT CAST(&#39;2015-01-11&#39; AS date) as SalesDate,  &#39;Digital&#39; as Subcategory,   
   &#39;Advanced Digital&#39; as Product, CAST(7234.50 AS money) AS Sales, 39 as Quantity  
UNION SELECT CAST(&#39;2015-01-07&#39; AS date) as SalesDate,  &#39;Digital&#39; as Subcategory,   
   &#39;Compact Digital&#39; as Product, CAST(10836.00 AS money) AS Sales, 84 as Quantity  
UNION SELECT CAST(&#39;2015-01-08&#39; AS date) as SalesDate,  &#39;Digital&#39; as Subcategory,   
   &#39;Consumer Digital&#39; as Product, CAST(2550.00 AS money) AS Sales, 17 as Quantity  
UNION SELECT CAST(&#39;2015-01-05&#39; AS date) as SalesDate, &#39;Digital&#39; as Subcategory,   
   &#39;Slim Digital&#39; as Product, CAST(8357.80 AS money) AS Sales, 44 as Quantity  
UNION SELECT CAST(&#39;2015-01-09&#39; AS date) as SalesDate, &#39;Digital SLR&#39; as Subcategory,   
   &#39;SLR Camera 35mm&#39; as Product, CAST(18530.00 AS money) AS Sales, 34 as Quantity  
UNION SELECT CAST(&#39;2015-01-07&#39; AS date) as SalesDate, &#39;Digital SLR&#39; as Subcategory,   
   &#39;SLR Camera&#39; as Product, CAST(26576.00 AS money) AS Sales, 88 as Quantity
</code></pre>
<p>创建一个矩形向导</p>
<ol>
<li><p>在“排列字段”页上，将 Product 拖到“值”中。</p>
</li>
<li><p>将 Quantity 拖到“值”中并将其置于 Product 下方。</p>
<p>将使用汇总数值字段的默认函数 Sum 函数对 Quantity 进行汇总。</p>
</li>
<li><p>将 Sales 拖到“值”中并将其放在 Quantity 下面。</p>
<p>步骤 1、2 和 3 指定要在表中显示的数据。</p>
</li>
<li><p>将 SalesDate 拖到“行组”中。</p>
</li>
<li><p>将 Subcategory 拖到“行组”中并将其置于 SalesDate 下方。</p>
<p>步骤 4 和 5 首先按日期组织字段的值，然后按照该日期的所有销售组织字段的值。</p>
</li>
</ol>
<p>选中最后一列第二行的文本框，右键打开文本框属性，选择填充，修改表达式（fx）<code>=IIF(Sum(Fields!Sales.Value) &gt;= 5000 ,&quot;Lime&quot;, IIF(Sum(Fields!Sales.Value) &lt; 2500, &quot;Red&quot;,&quot;Yellow&quot;))</code></p>
<p><code>[Sum(Sales)]</code> 的聚合汇总大于或等于 5000 的每个单元，其背景色会变为“暗黄绿色”。 2500 和 5000 之间的 <code>[Sum(Sales)]</code> 值会变为“黄色”。 小于 2500 的值会变为“红色”。</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0hCq.png"></p>
<p>运行结果图：</p>
<p><img src="https://docs.microsoft.com/zh-cn/sql/reporting-services/media/report-builder-kpi-colors.png?view=sql-server-ver15"></p>
<h4 id="6-2-使用仪表显示KPI的当前状态"><a href="#6-2-使用仪表显示KPI的当前状态" class="headerlink" title="6.2 使用仪表显示KPI的当前状态"></a>6.2 使用仪表显示KPI的当前状态</h4><p>接着，在最右侧插入列，列标题键入Linear KPI，在插入选项卡的仪表中，选择线性中的水平</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D041P.png"></p>
<p>此时在设计图面会添加一个仪表，将sales添加到仪表数据的值中</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0ALO.png">同样的可以通过收缩按钮打开线性指针属性，确保<strong>指针选项</strong>中的<strong>指针类型</strong>为条形图，接着选中刻度右键单击打开刻度属性，将最大值设置为25000</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0qum.png"></p>
<p>同时这里我们将显示标签取消勾选</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0DdA.png"></p>
<p>并且将仪表拖入图中文本框中</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0d3S.png"></p>
<p>运行结果：</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0lER.png"></p>
<h4 id="6-3-使用指示器显示KPI的当前状态"><a href="#6-3-使用指示器显示KPI的当前状态" class="headerlink" title="6.3 使用指示器显示KPI的当前状态"></a>6.3 使用指示器显示KPI的当前状态</h4><p>暂无</p>
<h3 id="7-关于地图报表"><a href="#7-关于地图报表" class="headerlink" title="7.关于地图报表"></a>7.关于地图报表</h3><h4 id="7-1-添加地图"><a href="#7-1-添加地图" class="headerlink" title="7.1 添加地图"></a>7.1 添加地图</h4><p>暂无</p>
<h3 id="8-表达式"><a href="#8-表达式" class="headerlink" title="8.表达式"></a>8.表达式</h3><h4 id="8-1显示名字首字母和姓氏"><a href="#8-1显示名字首字母和姓氏" class="headerlink" title="8.1显示名字首字母和姓氏"></a>8.1显示名字首字母和姓氏</h4><pre><code class="sql">SELECT &#39;Lauren&#39; AS FirstName,&#39;Johnson&#39; AS LastName, &#39;American Samoa&#39; AS StateProvince, 1 AS CountryRegionID,&#39;Female&#39; AS Gender, CAST(9996.60 AS money) AS YTDPurchase, CAST(&#39;2015-6-10&#39; AS date) AS LastPurchase  
UNION SELECT&#39;Warren&#39; AS FirstName, &#39;Pal&#39; AS LastName, &#39;New South Wales&#39; AS StateProvince, 2 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(5747.25 AS money) AS YTDPurchase, CAST(&#39;2015-7-3&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Fernando&#39; AS FirstName, &#39;Ross&#39; AS LastName, &#39;Alberta&#39; AS StateProvince, 3 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(9248.15 AS money) AS YTDPurchase, CAST(&#39;2015-10-17&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Rob&#39; AS FirstName, &#39;Caron&#39; AS LastName, &#39;Northwest Territories&#39; AS StateProvince, 3 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(742.50 AS money) AS YTDPurchase, CAST(&#39;2015-4-29&#39; AS date) AS LastPurchase  
UNION SELECT &#39;James&#39; AS FirstName, &#39;Bailey&#39; AS LastName, &#39;British Columbia&#39; AS StateProvince, 3 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(1147.50 AS money) AS YTDPurchase, CAST(&#39;2015-6-15&#39; AS date) AS LastPurchase  
UNION SELECT  &#39;Bridget&#39; AS FirstName, &#39;She&#39; AS LastName, &#39;Hamburg&#39; AS StateProvince, 4 AS CountryRegionID, &#39;Female&#39; AS Gender, CAST(7497.30 AS money) AS YTDPurchase, CAST(&#39;2015-5-10&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Alexander&#39; AS FirstName, &#39;Martin&#39; AS LastName, &#39;Saxony&#39; AS StateProvince, 4 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(2997.60 AS money) AS YTDPurchase, CAST(&#39;2015-11-19&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Yolanda&#39; AS FirstName, &#39;Sharma&#39; AS LastName ,&#39;Micronesia&#39; AS StateProvince, 5 AS CountryRegionID, &#39;Female&#39; AS Gender, CAST(3247.95 AS money) AS YTDPurchase, CAST(&#39;2015-8-23&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Marc&#39; AS FirstName, &#39;Zimmerman&#39; AS LastName, &#39;Moselle&#39; AS StateProvince, 6 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(1200.00 AS money) AS YTDPurchase, CAST(&#39;2015-11-16&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Katherine&#39; AS FirstName, &#39;Abel&#39; AS LastName, &#39;Moselle&#39; AS StateProvince, 6 AS CountryRegionID, &#39;Female&#39; AS Gender, CAST(2025.00 AS money) AS YTDPurchase, CAST(&#39;2015-12-1&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Nicolas&#39; as FirstName, &#39;Anand&#39; AS LastName, &#39;Seine (Paris)&#39; AS StateProvince, 6 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(1425.00 AS money) AS YTDPurchase, CAST(&#39;2015-12-11&#39; AS date) AS LastPurchase  
UNION SELECT &#39;James&#39; AS FirstName, &#39;Peters&#39; AS LastName, &#39;England&#39; AS StateProvince, 12 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(887.50 AS money) AS YTDPurchase, CAST(&#39;2015-8-15&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Alison&#39; AS FirstName, &#39;Nath&#39; AS LastName, &#39;Alaska&#39; AS StateProvince, 7 AS CountryRegionID, &#39;Female&#39; AS Gender, CAST(607.50 AS money) AS YTDPurchase, CAST(&#39;2015-10-13&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Grace&#39; AS FirstName, &#39;Patterson&#39; AS LastName, &#39;Kansas&#39; AS StateProvince, 7 AS CountryRegionID, &#39;Female&#39; AS Gender, CAST(1215.00 AS money) AS YTDPurchase, CAST(&#39;2015-10-18&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Bobby&#39; AS FirstName, &#39;Sanchez&#39; AS LastName, &#39;North Dakota&#39; AS StateProvince, 7 AS CountryRegionID, &#39;Female&#39; AS Gender, CAST(6191.00 AS money) AS YTDPurchase, CAST(&#39;2015-9-17&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Charles&#39; AS FirstName, &#39;Reed&#39; AS LastName, &#39;Nebraska&#39; AS StateProvince, 7 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(8772.00 AS money) AS YTDPurchase, CAST(&#39;2015-8-27&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Orlando&#39; AS FirstName, &#39;Romeo&#39; AS LastName, &#39;Texas&#39; AS StateProvince, 7 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(8578.00 AS money) AS YTDPurchase, CAST(&#39;2015-7-29&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Cynthia&#39; AS FirstName, &#39;Randall&#39; AS LastName, &#39;Utah&#39; AS StateProvince, 7 AS CountryRegionID, &#39;Female&#39; AS Gender, CAST(7218.10 AS money) AS YTDPurchase, CAST(&#39;2015-1-11&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Rebecca&#39; AS FirstName, &#39;Roberts&#39; AS LastName, &#39;Washington&#39; AS StateProvince, 7 AS CountryRegionID, &#39;Female&#39; AS Gender, CAST(8357.80 AS money) AS YTDPurchase, CAST(&#39;2015-10-28&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Cristian&#39; AS FirstName, &#39;Petulescu&#39; AS LastName, &#39;Wisconsin&#39; AS StateProvince, 7 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(3470.00 AS money) AS YTDPurchase, CAST(&#39;2015-11-30&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Cynthia&#39; AS FirstName, &#39;Randall&#39; AS LastName, &#39;Utah&#39; AS StateProvince, 7 AS CountryRegionID, &#39;Female&#39; AS Gender, CAST(7218.10 AS money) AS YTDPurchase, CAST(&#39;2015-1-11&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Rebecca&#39; AS FirstName, &#39;Roberts&#39; AS LastName, &#39;Washington&#39; AS StateProvince, 7 AS CountryRegionID, &#39;Female&#39; AS Gender, CAST(8357.80 AS money) AS YTDPurchase, CAST(&#39;2015-10-28&#39; AS date) AS LastPurchase  
UNION SELECT &#39;Cristian&#39; AS FirstName, &#39;Petulescu&#39; AS LastName, &#39;Wisconsin&#39; AS StateProvince, 7 AS CountryRegionID, &#39;Male&#39; AS Gender, CAST(3470.00 AS money) AS YTDPurchase, CAST(&#39;2015-11-30&#39; AS date) AS LastPurchase
</code></pre>
<p>创建一个矩形向导，将下列字段拖到<strong>值</strong>当中，其中CountryRegionID和YTDPurchase包含数值数据，所以SUM聚合默认应用于这两个字段，这里右键单击字段取消选中SUM</p>
<ul>
<li>StateProvince</li>
<li>CountryRegionID</li>
<li>LastPurchase</li>
<li>YTDPurchase</li>
</ul>
<p>接下来插入一个新列，用来展示名字，右键单击该列的数据单元（文本框）选择表达式，如图：将<strong>Left</strong>函数添加到表达式中<code>=Left(</code></p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0pXJ.png"></p>
<p>单击<strong>字段(Expressions)<strong>在</strong>值</strong>列表中双击<strong>FirstName</strong>，随后在上面文本输入<code>,1)</code>,当前的表达式为<code>=Left(Fields!FirstName.Value,1)</code></p>
<p>意思为：从FirstName值提取一个字符，从左侧开始计数</p>
<p>随后加上字符<code>&amp; &quot; &quot; &amp;</code>,&amp;为拼接，中间引号是一段空格，随后再跟上名字的表达式 <code>Fields!LastName.Value</code></p>
<p>完整表达式：<code>=Left(Fields!FirstName.Value, 1) &amp;&quot;. &quot;&amp; Fields!LastName.Value</code></p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0z60.png"></p>
<p>运行结果：</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0WRv.png"></p>
<h4 id="8-2-设置日期列的格式"><a href="#8-2-设置日期列的格式" class="headerlink" title="8.2 设置日期列的格式"></a>8.2 设置日期列的格式</h4><p>选中Last Purchase列下的数据单元，在主页的选项卡上修改默认值为日期，并显示示例值（顺带一提，一旁的$符号可以修改成货币）</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D00CF.png"></p>
<h4 id="8-3-使列按条件进行颜色显示，并更改矩形格式"><a href="#8-3-使列按条件进行颜色显示，并更改矩形格式" class="headerlink" title="8.3 使列按条件进行颜色显示，并更改矩形格式"></a>8.3 使列按条件进行颜色显示，并更改矩形格式</h4><p>这里用性别来演示，首先新插入列，在数据单元中添加一个<strong>矩形</strong>，然后右键单击打开<strong>矩形属性</strong></p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0sbW.png"></p>
<p>打开填充，打开填充颜色的表达式，在类别的常见函数下的程序流中中向文本添加Switch <code>=Switch(</code> </p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0Iyy.png"></p>
<p>然后打开<strong>字段(Expressions)<strong>，加入</strong>值</strong>列表中的Gender，给上条件</p>
<p><code>=&quot;Male&quot;,</code> 注意需要加上英文逗号，然后在常量当中选择自己想要的颜色，之后仿照前面一段内容用英文逗号再次进行分段，输入(或者按流程点击)</p>
<p><code>Fields!Gender.Value = &quot;Female&quot;,&quot;Green&quot;)</code>,如图</p>
<p>完整表达式：<code>=Switch(Fields!Gender.Value =&quot;Male&quot;, &quot;CornflowerBlue&quot;,Fields!Gender.Value =&quot;Female&quot;,&quot;Tomato&quot;)</code></p>
<p>打开矩形的属性窗口更改下列属性</p>
<ul>
<li>BorderColor &#x3D; 白色</li>
<li>BorderStyle &#x3D; 实线</li>
<li>BorderWidth &#x3D; 5pt</li>
</ul>
<p>运行效果：</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0Rdk.png"></p>
<h4 id="8-4-两个数据集联合查找"><a href="#8-4-两个数据集联合查找" class="headerlink" title="8.4 两个数据集联合查找"></a>8.4 两个数据集联合查找</h4><p>新建一个数据集</p>
<pre><code class="sql">SELECT 1 AS ID, &#39;American Samoa&#39; AS CountryRegion  
UNION SELECT 2 AS CountryRegionID, &#39;Australia&#39; AS CountryRegion  
UNION SELECT 3 AS ID, &#39;Canada&#39; AS CountryRegion  
UNION SELECT 4 AS ID, &#39;Germany&#39; AS CountryRegion  
UNION SELECT 5 AS ID, &#39;Micronesia&#39; AS CountryRegion  
UNION SELECT 6 AS ID, &#39;France&#39; AS CountryRegion  
UNION SELECT 7 AS ID, &#39;United States&#39; AS CountryRegion  
UNION SELECT 8 AS ID, &#39;Brazil&#39; AS CountryRegion  
UNION SELECT 9 AS ID, &#39;Mexico&#39; AS CountryRegion  
UNION SELECT 10 AS ID, &#39;Japan&#39; AS CountryRegion  
UNION SELECT 10 AS ID, &#39;Australia&#39; AS CountryRegion  
UNION SELECT 12 AS ID, &#39;United Kingdom&#39; AS CountryRegion
</code></pre>
<p>选择CountryRegionID列下的数据单元，右键单击选择</p>
<p>表达式，在“表达式”对话框中，展开“常见函数”，然后单击“杂项”，在“项”列表中，双击“查找” Lookup</p>
<p>完整表达式为：<code>=Lookup(Fields!CountryRegionID.Value,Fields!ID.value, Fields!CountryRegion.value, &quot;CountryRegion&quot;)</code></p>
<p>Lookup函数的语法指定对表达式数据集的CountryRegionID和CountryRegion数据集中ID进行查找，CountryRegion 数据集中的 CountryRegion 值</p>
<h4 id="8-5-日期"><a href="#8-5-日期" class="headerlink" title="8.5 日期"></a>8.5 日期</h4><p>新插入一列，标题键入”Days Ago”,打开该列的数据单元格的表达式，在常见函数中选择日期时间，使用DateDiff函数，它可以返回两个指定时间的时间间隔</p>
<p>完整表达式为：&#x3D;DateDiff(“d”, Fields!LastPurchase.Value, Now)</p>
<p>其中d表示“天”，值中日期距离至今的天数</p>
<p>运行结果：</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0ap2.png"></p>
<h4 id="8-6-比较"><a href="#8-6-比较" class="headerlink" title="8.6 比较"></a>8.6 比较</h4><p>插入一个新列，键入 “+ or - AVG Sales”</p>
<p>在该列数据单元格中插入一个方向指示器</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D01y7.png"></p>
<p>右键打开指示器属性，更改值得表达式</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0kbM.png"></p>
<p>展开常见函数，Math 之后双击Round（将双精度浮点值舍入为最接近的整数）</p>
<p>完整表达式为：<code>Round(Fields!YTDPurchase.Value - Avg(Fields!YTDPurchase.Value, &quot;Expressions&quot;))</code></p>
<p>然后选择指示器状态的第一行↓图标，更改开始的表达式</p>
<p>完整表达式为：<code>=Round(Fields!YTDPurchase.Value - Avg(Fields!YTDPurchase.Value, &quot;Expressions&quot;)) &lt; 0</code></p>
<p>将→图标删除，在←图标的结束上修改表达式</p>
<p><code>=Round(Fields!YTDPurchase.Value - Avg(Fields!YTDPurchase.Value, &quot;Expressions&quot;)) &gt; 0</code></p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0blX.png"></p>
<p>运行效果：</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0FKZ.png"></p>
<h4 id="8-6-镶边报表"><a href="#8-6-镶边报表" class="headerlink" title="8.6 镶边报表"></a>8.6 镶边报表</h4><p>应用于报表的交替行的颜色</p>
<p>首先新增一个参数，打开参数属性，选择颜色，在名称中输入RowColor，在<strong>可用值面板</strong>上选中<strong>指定值</strong>进行添加</p>
<p><img src="https://s1.328888.xyz/2022/05/18/D0VPC.png"></p>
<p>完成之后选中需要交替颜色的单元格，一般是选中数据行所有的单元格，个别除外，在属性中选中background，点击向下箭头单击表达式Expression，然后展开常见函数，选择程序流的IIF</p>
<p>完整表达式：<code>=IIF(RowNumber(Nothing) MOD 2, Parameters!RowColor.Value, &quot;White&quot;)</code></p>
<p>运行结果如上图的颜色交替</p>

    </div>
    
    <link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.css">
    <div id="comment">
        <div id="gitalk-container">
        </div>
    </div>
    
</div>
                         
<footer id="footer">
    <div class="footer-wrap">
        <div>
            © 2022 - 2022 OneFrog
            <span class="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            @一只青蛙
        </div>
        <div>
		</div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a> & <a
                target="_blank" rel="noopener" href="https://github.com/korilin/hexo-theme-particle">Particle Theme</a></div>
        
			
			<div>
			<p>
				>>> 网站已平稳运行：<span id="site_runtime" style="color: #24a0f0;"></span><<<
			</p>
			</div>
    </div>
</footer>
                    </div>
                </div>
            </transition>
            <div id="img_show">
                <img id="img_content" alt="img_show">
            </div>
        </div>
		<canvas
		    id="background"
		    style="position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:-1"
		></canvas>
        <script src="https://cdn.staticfile.org/highlight.js/11.5.1/highlight.min.js"></script>
        <script src="/js/particlex.js"></script>
        <script src="/js/showimg.js"></script>
		<script src="/js/background.js"></script>
		<script src="/js/clicklove.js"></script>
		<script src="/js/FunnyTitle.js"></script>
		<script type="text/javascript">
		    function show_site_runtime(){
		    window.setTimeout("show_site_runtime()",1000); // 每秒运行一次函数
		    X=new Date("04/21/2021 00:00:00"); //在这里修改你的建站时间
		    Y=new Date();
		    T=(Y.getTime()-X.getTime()); // 获取当前时间与指定时间之间的时间间隔（ms）
		    i=24*60*60*1000;
		    d=T/i;
		    D=Math.floor(d); // 计算天数并向下取整
		    h=(d-D)*24;
		    H=Math.floor(h); // 计算剩余不足一天的小时数并向下取整
		    m=(h-H)*60;
		    M=Math.floor(m); // 计算剩余不足一小时的分钟数并向下取整
		    s=(m-M)*60
		    S=Math.floor(s); // 计算剩余不足一分钟的秒数并向下取整
		    site_runtime.innerHTML= Y+D + " 天 " + H + " 小时 " + M + " 分 " + S + " 秒 "
		    }
		    show_site_runtime();
		</script>
        
<script src="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.js"></script>
<script>
    var clientID = "", clientSecret = "";
    
    const gitalk = new Gitalk({
        clientID: clientID,
        clientSecret: clientSecret,
        repo: "",
        owner: "",
        admin: [""],
        language: "zh-CN",
        id: location.pathname,
        distractionFreeMode: true
    })
    gitalk.render("gitalk-container")
</script>


    </body>
</html>